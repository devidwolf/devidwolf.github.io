{% extends "./layouts/base.html" %}

{% block content %}

<video id="landing-vid" type="video/webm" autoplay muted disablePictureInPicture></video>

<main class="landing-container">

  <div class="landing">
    <div class="toCode bg-box" translate="no">
      <span id="dev">d<span id="a-e">a</span>v</span><span id="attr"><span id="id">id</span><span id="wolf">wolf</span></span>
    </div>
  </div>

</main>

<script>
  $(function() {

    let videos, currentVideoIndex;
    videos = [
      {% for v in LANDING_VIDEOS %}
      {{ '\'{0}/media/videos/{1}\','.format(SITEURL, v) }}
      {% endfor %}
      ];
    // if not set already set random starting video index
    // console.log(utils.getCookie('sessionVid'));
    videoIndex = utils.getCookie('sessionVid') ? utils.getCookie('sessionVid') : utils.setCookie('sessionVid', Math.floor(Math.random() * videos.length));

    $('#landing-vid').attr('src', videos[videoIndex]);
    $('#landing-vid').trigger('play');

    // video autoplay playlist
    // https://stackoverflow.com/a/17522421/13765033
    $('#landing-vid').on('ended', function() {
      videoIndex++;
      if (videoIndex === videos.length) videoIndex = 0;
      // console.log(videos[videoIndex]);
      $(this).attr('src', videos[videoIndex]);
      $(this).trigger('play');
    });

  });
</script>

{% endblock %}
